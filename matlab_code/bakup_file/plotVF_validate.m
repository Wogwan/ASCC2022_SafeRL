format long
hold on;
syms x1 x2;
dom = 1.5;
g = 10;
l = 1;
m = 1;

%%
% Taylor SOSU
% +1.219764086126079e-17*x(1)^4-1.343779958599505e-16*x(1)^3*x(2)+3.982244282547236e-17*x(1)^2*x(2)^2+6.907225815640202e-16*x(1)*x(2)^3-1.323550009820473e-16*x(2)^4-1.714317503994803*x(1)^3-0.1398582323617057*x(1)^2*x(2)+0.3922007227373469*x(1)*x(2)^2-0.3632011062978188*x(2)^3+9.260243826800486e-17*x(1)^2+7.624698760177571e-16*x(1)*x(2)-2.940385214136951e-17*x(2)^2+9.287295441689839*x(1)-1.018711883885878*x(2)-7.766390436219612e-23

% Chebyshev U
% +1.219764086126079e-17*x(1)^4-1.343779958599505e-16*x(1)^3*x(2)+3.982244282547236e-17*x(1)^2*x(2)^2+6.907225815640202e-16*x(1)*x(2)^3-1.323550009820473e-16*x(2)^4-1.714317503994803*x(1)^3-0.1398582323617057*x(1)^2*x(2)+0.3922007227373469*x(1)*x(2)^2-0.3632011062978188*x(2)^3+9.260243826800486e-17*x(1)^2+7.624698760177571e-16*x(1)*x(2)-2.940385214136951e-17*x(2)^2+9.287295441689839*x(1)-1.018711883885878*x(2)-7.766390436219612e-23

% figure(10);clf;hold on;
% f = @(t,x)[
%     x(2)
%     -10*sin(x(1))];

% figure(11);clf;hold on;
% f = @(t,x)[
%     x(2)
%     -x(1)^5/12+(5*x(1)^3)/3-10*x(1)];

% figure(12);clf;hold on;
% f = @(t,x)[
%     x(2)
%     -0.070421222500154631585012054983963*x(1)^5-0.00000000000000071054273576010022531416952862872*x(1)^4+1.6415384826007917012935521938743*x(1)^3+0.0000000000000021316282072803006759425085858861*x(1)^2-9.9876513003548918895324604250163*x(1)-0.0000000000000015987211554602254576530748631014];

% figure(20);clf;hold on;
% f = @(t,x)[
%     x(2)
%     -10*sin(x(1))+1.219764086126079e-17*x(1)^4-1.343779958599505e-16*x(1)^3*x(2)+3.982244282547236e-17*x(1)^2*x(2)^2+6.907225815640202e-16*x(1)*x(2)^3-1.323550009820473e-16*x(2)^4-1.714317503994803*x(1)^3-0.1398582323617057*x(1)^2*x(2)+0.3922007227373469*x(1)*x(2)^2-0.3632011062978188*x(2)^3+9.260243826800486e-17*x(1)^2+7.624698760177571e-16*x(1)*x(2)-2.940385214136951e-17*x(2)^2+9.287295441689839*x(1)-1.018711883885878*x(2)-7.766390436219612e-23];

% figure(21);clf;hold on;
% f = @(t,x)[
%     x(2)
%     -x(1)^5/12+(5*x(1)^3)/3-10*x(1)+1.219764086126079e-17*x(1)^4-1.343779958599505e-16*x(1)^3*x(2)+3.982244282547236e-17*x(1)^2*x(2)^2+6.907225815640202e-16*x(1)*x(2)^3-1.323550009820473e-16*x(2)^4-1.714317503994803*x(1)^3-0.1398582323617057*x(1)^2*x(2)+0.3922007227373469*x(1)*x(2)^2-0.3632011062978188*x(2)^3+9.260243826800486e-17*x(1)^2+7.624698760177571e-16*x(1)*x(2)-2.940385214136951e-17*x(2)^2+9.287295441689839*x(1)-1.018711883885878*x(2)-7.766390436219612e-23];

figure(22);clf;hold on;
f = @(t,x)[
    x(2)
    -0.070421222500154631585012054983963*x(1)^5-0.00000000000000071054273576010022531416952862872*x(1)^4+1.6415384826007917012935521938743*x(1)^3+0.0000000000000021316282072803006759425085858861*x(1)^2-9.9876513003548918895324604250163*x(1)-0.0000000000000015987211554602254576530748631014++1.219764086126079e-17*x(1)^4-1.343779958599505e-16*x(1)^3*x(2)+3.982244282547236e-17*x(1)^2*x(2)^2+6.907225815640202e-16*x(1)*x(2)^3-1.323550009820473e-16*x(2)^4-1.714317503994803*x(1)^3-0.1398582323617057*x(1)^2*x(2)+0.3922007227373469*x(1)*x(2)^2-0.3632011062978188*x(2)^3+9.260243826800486e-17*x(1)^2+7.624698760177571e-16*x(1)*x(2)-2.940385214136951e-17*x(2)^2+9.287295441689839*x(1)-1.018711883885878*x(2)-7.766390436219612e-23];

%% Chebyshev
% f = @(t,x)[
%     x(2)
%     -10.25979232788086*x(1)^4-0.00425688736140728*x(2)^4+0.2569154087425854*x(1)+0.0003267154970670871];

% f = @(t,x)[
%     x(2)
%     -10.259792327880859375*x(1)^4+0.25691540874258537533828909242099*x(1)-0.00425688736140727996826171875*x(2)^4+0.00032671549706708713500802332418971+10.25526610776048*x(1)^4+0.001245539868176279*x(1)^3*x(2)+0.0006474285158632796*x(1)^2*x(2)^2-0.0001281080021772417*x(1)*x(2)^3+0.004259059898897862*x(2)^4-0.09327256500809404*x(1)^3-0.1072141420382513*x(1)^2*x(2)+0.3802395778083186*x(1)*x(2)^2-0.3639118929984619*x(2)^3+0.0008593525761658776*x(1)^2-0.0007313467366820914*x(1)*x(2)+0.0001614076393595181*x(2)^2-0.9635092863983593*x(1)-1.013522856170644*x(2)-0.0003267154911549466    ];

% f = @(t,x)[
%     x(2)
%     -10*sin(x(1))+10.25526610776048*x(1)^4+0.001245539868176279*x(1)^3*x(2)+0.0006474285158632796*x(1)^2*x(2)^2-0.0001281080021772417*x(1)*x(2)^3+0.004259059898897862*x(2)^4-0.09327256500809404*x(1)^3-0.1072141420382513*x(1)^2*x(2)+0.3802395778083186*x(1)*x(2)^2-0.3639118929984619*x(2)^3+0.0008593525761658776*x(1)^2-0.0007313467366820914*x(1)*x(2)+0.0001614076393595181*x(2)^2-0.9635092863983593*x(1)-1.013522856170644*x(2)-0.0003267154911549466];

%% Field [-2 2]
% vectfield(f,-dom:dom/10:dom,-dom:dom/10:dom); hold on; % field [-5 5 -5 5]
for xd = -dom:dom/5:dom
    for yd = -dom:dom/5:dom
        [ts,ys] = ode45(f,[0,20],[xd;yd]);
        h1 = plot(ys(:,1),ys(:,2), 'k');hold on;
        refreshdata; drawnow;
    end
end
xlim([-dom dom]); ylim([-dom dom]);
plot(0,0,'c*','linewidth',2);hold on;
set(gca, 'LooseInset', [0,0,0,0]);
title('');